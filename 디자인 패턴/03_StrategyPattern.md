# 전략 패턴 Strategy Pattern
정책 패턴(policy pattern)이라고도 함  
객체의 행위를 전략으로 만들어 놓고 동적으로 수정하는 패턴  
객체의 행위를 바꾸고 싶은 경우 '직접'수정하지 않고 전략이라고 부르는 '캡슐화한 알고리즘'을 컨텍스트 안에서 바꿔주면서 상호 교체가 가능하게 만드는 패턴.  

동일계열로 알고리즘을 정의한다.  

필요한 것  
1. 전략을 담고 있는 변수, 2. 전략의 알고리즘을 수행하는 메서드, 3. 다른 전략으로 바꿀 수 있는 메서드 




예제)  
결제를 한다. 네이버 페이로 결제한다. 카카오 페이로 결제한다. 
결제 방식의 두가지의 전략

목적지까지 이동한다. 자가용을 탄다. 버스를 탄다. 지하철을 탄다. 걷는다.

구현예제는?  

피카츄가 공격한다. 몸통박치기, 전광석화   
두가지 공격 전략이 있음  
새로운 공격 전략 추가. 백만볼드  

공격 전략 이외에 새로운 전략 추가?

피카츄가 아이템을 사용한다. 


## swift로 팩토리 패턴 만들어보기

```swift
import UIKit

// Strategy Pattern

// 공격 전략
protocol 공격전략프로토콜 {
    func 공격하기()
}

class 몸통박치기: 공격전략프로토콜 {
    func 공격하기() {
        print("몸통박치기 !!!")
    }
}

class 전광석화: 공격전략프로토콜 {
    func 공격하기() {
        print("전광석화 !!!")
    }
}

// 신규 기능
class 백만볼트: 공격전략프로토콜 {
    func 공격하기() {
        print("백.만.볼.트. !!!")
    }
}

// 피카츄 클래스
// 공격시 한가지의 공격전략을 채택하여 공격한다.
class 피카츄 {
    var 공격전략: 공격전략프로토콜

    init(공격전략: 공격전략프로토콜) {
        self.공격전략 = 공격전략
    }

    func 공격전략수정(to 공격전략: 공격전략프로토콜) {
        self.공격전략 = 공격전략
    }

    func 공격() {
        공격전략.공격하기()
    }
}

let 지우의피카츄 = 피카츄(공격전략: 몸통박치기())
지우의피카츄.공격() // 몸통박치기 !!!

// 지우는 피카츄가 전광석화를 사용하길 원한다.
지우의피카츄.공격전략수정(to: 전광석화())
지우의피카츄.공격() // 전광석화 !!!


// 이제 피카츄는 새로운 공격인 백만볼트를 사용할 수 있다.
// class 백만볼트 추가
지우의피카츄.공격전략수정(to: 백만볼트())
지우의피카츄.공격() // 백.만.볼.트. !!!


```


## 언제 사용하면 좋을까?
하나의 동작이 여러 방법으로 수행될수 있는 경우, 런타임에 방법들을 자류롭게 교체하고 싶은 경우.  

객체의 책임을 줄이고 싶을때.  

클래스의 상속에서 기능의 확장이 필요한 경우.  

## 장점
런타임 중에 프로그램의 알고리즘을 선택하고 변경할 수 있음  
Strategy를 추가하거나 수정할 때 다른 코드를 수정할 일이 없으므로 SOLID 법칙의 OCP(Open-Closed Principle, 개방-폐쇄 원칙)를 지킬 수 있음  
각각의 알고리즘들은 모두 Strategy 프로토콜을 따르는 클래스로 따로 구현되기 때문에, Strategy를 사용하는 객체는 책임을 줄일 수 있음  
비즈니스 로직과 구체적인 알고리즘 구현부를 분리할 수 있음  
SRP(Single Responsibility Principle, 단일책임원칙)을 따를 수 있게 됨  
책임을 분리하여 테스트에도 용이



## 한계  
굳이 적용할 필요가 없을만큼 알고리즘 수가 적은 경우나 런타임에 변경될 일이 거의 없다면 패턴의 도입이 코드의 복잡성을 증가시킬 수 있음  



## 참조

[면접을 위한 CS 전공지식 노트 주홍철 저](https://github.com/gyoogle/tech-interview-for-developer)  
[야곰닷넷 디자인패턴](https://yagom.net/courses/design-pattern-in-swift/)
